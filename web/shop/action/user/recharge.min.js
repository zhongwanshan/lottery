(function(){new Vue({el:"#js-recharge",data:{userInfo:USERINFO,isAction:!1,canModify:1,rechargeInfo:{rechargeMoney:"",rechargePolicyId:"",remark:"",action:CONFIG.ACTION.userRrecharge},paramInfo:{rechargeMoney:"",rechargePolicyId:"",remark:"",goToUrl:"/shop/view/user/depRech.html",action:CONFIG.ACTION.userRrecharge},remark:"",rechargePolicyList:[]},watch:{"rechargeInfo.rechargePolicyId":function(e){for(var r=this,c=0,a=r.rechargePolicyList.length;c<a;c++)if(r.rechargePolicyList[c].rechargePolicyId==e){r.canModify=r.rechargePolicyList[c].canModify,r.paramInfo.rechargePolicyId=r.rechargePolicyList[c].rechargePolicyId,r.rechargeInfo.rechargePolicyId=r.rechargePolicyList[c].rechargePolicyId;break}}},methods:{userLogout:function(){utility.userLogout(function(){window.location.replace(CONFIG.HOST+"/shop/view/user/login.html")})},rechargeAction:function(){var e=this;if(1!=e.isAction)return utility.checkLen(e.rechargeInfo.rechargeMoney,0)?(app.showPreloader("请输入充值金额"),void setTimeout(function(){app.hidePreloader()},1e3)):void utility.interactWithServer({headerInfo:{appType:"2",userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.walletService,CONFIG.ACTION.userRrecharge,e.rechargeInfo)},url:CONFIG.HOST+CONFIG.SERVICE.walletService,dataObj:e.rechargeInfo,completeCallback:function(r,c){e.isAction=!1},successCallback:function(e){200==e.code||alert(e.message)}})},getRechargePolicy:function(){var e=this;utility.interactWithServer({headerInfo:{appType:"2",userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.walletService,CONFIG.ACTION.getRechargePolicy,{action:CONFIG.ACTION.getRechargePolicy})},url:CONFIG.HOST+CONFIG.SERVICE.walletService,dataObj:{action:CONFIG.ACTION.getRechargePolicy},successCallback:function(r){if(200==r.code){e.rechargePolicyList=r.data;for(var c=0,a=e.rechargePolicyList.length;c<a;c++)if(1==e.rechargePolicyList[c].canModify){e.paramInfo.rechargePolicyId=e.rechargePolicyList[c].rechargePolicyId,e.rechargeInfo.rechargePolicyId=e.rechargePolicyList[c].rechargePolicyId;break}}else alert(r.message)}})},doRechargeAction:function(){var e=this;return 1==e.canModify&&0==e.rechargeInfo.rechargeMoney?void alert("充值金额不能为0"):(e.rechargeInfo.remark=encodeURIComponent(e.remark),e.paramInfo.rechargeMoney=e.rechargeInfo.rechargeMoney,e.paramInfo.rechargePolicyId=e.rechargeInfo.rechargePolicyId,e.paramInfo.remark=e.rechargeInfo.remark,e.rechargeInfo.backUrl=CONFIG.HOST+"/shop/view/order/result.html?paramInfo="+encodeURI(JSON.stringify(e.paramInfo)),void(window.location.href=CONFIG.HOST+utility.formatActionUrl(CONFIG.SERVICE.walletService,CONFIG.ACTION.userRrecharge,e.rechargeInfo,!0)+"&userId="+USERINFO.userId+"&userToken="+USERINFO.userToken+"&appType=2"))}},created:function(){var e=this,r=utility.getQueryParams();e.getRechargePolicy(),r.code&&200!=r.code&&alert(r.message),setTimeout(function(){e.userInfo=USERINFO},1e3)}})})();