(function(){new Vue({el:"#js-pageIdentity",data:{userInfo:USERINFO,isAction:!1,userAccount:"",payPwd:"",paramInfo:{action:CONFIG.ACTION.identifyRealUser,smsCode:"",realUserName:"",idCardNo:""},imgSrc:"",imgCode:"",reqId:"",time:null,smsTxt:"获取验证码"},methods:{userLogout:function(){utility.userLogout(function(){window.location.replace(CONFIG.HOST+"/shop/view/user/login.html")})},getImgCode:function(){var e=this;utility.getImgCode(function(t){e.reqId=t.data.reqId,e.imgSrc=t.data.imgCodeUrl})},getSmsCode:function(){var e=this;if(1!=e.isAction)return utility.checkLen(e.userAccount,0)?void alert("手机号不能为空"):utility.checkPhone(e.userAccount)?void utility.checkImgCode(e.reqId,e.imgCode,function(){utility.getSmsCode(e.reqId,e.imgCode,e.userAccount,"7",function(){var t=60;e.time=setInterval(function(){t--,e.smsTxt="还有"+t+"秒",0==t&&(e.smsTxt="重新发送",clearInterval(e.time))},1e3)},function(){e.isAction=!1})}):void alert("手机号格式错误")},doAction:function(){var e=this;if(1!=e.isAction)return utility.checkLen(e.userAccount,0)?void alert("手机号不能为空"):utility.checkPhone(e.userAccount)?utility.checkLen(e.paramInfo.smsCode,0)?void alert("验证码不能为空"):utility.checkLen(e.paramInfo.realUserName,0)?void alert("真实姓名不能为空"):utility.checkLen(e.paramInfo.idCardNo,0)?void alert("身份证号不能为空"):utility.checkIdentityNo(e.paramInfo.idCardNo)?void utility.interactWithServer({headerInfo:{appType:"2",userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.commonService,CONFIG.ACTION.identifyRealUser,e.paramInfo)},url:CONFIG.HOST+CONFIG.SERVICE.commonService,dataObj:e.paramInfo,completeCallback:function(t,i){e.isAction=!1},successCallback:function(e){200==e.code?window.location.href=window.history.back():alert(e.message)}}):void alert("身份证号格式不对"):void alert("手机号格式错误")}},created:function(){var e=this;e.getImgCode(),setTimeout(function(){e.userInfo=USERINFO},1e3)}})})();