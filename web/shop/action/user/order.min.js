(function(){new Vue({el:"#js-pageOrder",data:{userInfo:USERINFO,isClick:!1,orderParam:{action:CONFIG.ACTION.getOrderList,pageSize:10,pageNum:1,lotteryTypeId:"",beginDay:"",endDay:"",orderStatus:"",sysOpStr:"sss@2018",shopDealStatus:"",shopId:USERINFO.userId},pageCount:1,orderList:[],lotterIdList:CONFIG.LOTTERYID,orderStatuList:CONFIG.ORDERSTATU,shopDealStatus:CONFIG.SHOPDEALSTATUS},methods:{userLogout:function(){utility.userLogout(function(){window.location.replace(CONFIG.HOST+"/shop/view/user/login.html")})},getByPage:function(e){var r=this;r.orderParam.pageNum=e,r.getOrderList()},getOrderList:function(e){var r=this;1==e&&(r.orderParam.pageNum=1),utility.interactWithServer({headerInfo:{appType:"2",userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.commonOrderService,CONFIG.ACTION.getOrderList,r.orderParam)},url:CONFIG.HOST+CONFIG.SERVICE.commonOrderService,dataObj:r.orderParam,successCallback:function(e){200==e.code&&(e.data.length>0?(r.pageCount=Math.ceil(e.count/r.orderParam.pageSize),r.orderList=e.data):r.orderList=[])}})},getPreViewData:function(){var e=this;e.orderParam.pageNum>1&&(e.orderParam.pageNum=e.orderParam.pageNum-1,e.getOrderList())},getNextData:function(){var e=this;e.orderParam.pageNum<e.pageCount&&(e.orderParam.pageNum=e.orderParam.pageNum+1,e.getOrderList())},modifyOrderByShop:function(e,r){var t=this;if(confirm("确定修改?")){if(1==t.isClick)return;utility.interactWithServer({headerInfo:{appType:"2",userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.commonOrderService,CONFIG.ACTION.modifyOrderByShop,{shopWorkerId:USERINFO.userId,shopDealStatus:e,action:CONFIG.ACTION.modifyOrderByShop,orderCode:r,sysOpStr:"sss@2018"})},url:CONFIG.HOST+CONFIG.SERVICE.commonOrderService,dataObj:{shopWorkerId:USERINFO.userId,shopDealStatus:e,action:CONFIG.ACTION.modifyOrderByShop,orderCode:r,sysOpStr:"sss@2018"},completeCallback:function(){t.isClick=!1},successCallback:function(e){200==e.code?(t.getOrderList(),utility.getShopOrderStat(function(e){USERINFO.totalUntreatedOrders=e.data.totalUntreatedOrders,USERINFO.totalReceivedOrders=e.data.totalReceivedOrders,USERINFO.totalPrintedOrders=e.data.totalPrintedOrders,USERINFO.totalOrders=e.data.totalOrders,USERINFO.totalRejectedOrders=e.data.totalRejectedOrders,t.userInfo=USERINFO})):alert(e.message)}})}}},created:function(){var e=this;e.getOrderList(!0),setTimeout(function(){e.userInfo=USERINFO},1e3)},mounted:function(){var e=this;$("#starTime").fdatepicker({format:"yyyy-mm-dd"}).on("changeDate",function(r){e.orderParam.beginDay=$("#starTime").val()}),$("#endTime").fdatepicker({format:"yyyy-mm-dd"}).on("changeDate",function(r){e.orderParam.endDay=$("#endTime").val()})}})})();