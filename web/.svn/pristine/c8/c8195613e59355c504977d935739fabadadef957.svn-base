(function(){new Vue({el:"#js-recharge",data:{isAction:!1,canModify:0,rechargeInfo:{rechargeMoney:"",rechargePolicyId:"",remark:"",action:CONFIG.ACTION.userRrecharge},paramInfo:{rechargeMoney:"",rechargePolicyId:"",remark:"",goToUrl:"/app/view/account/account.html",action:CONFIG.ACTION.userRrecharge},remark:"",isShowCash:!1,payPwd:"",rechargePolicyList:[]},watch:{"rechargeInfo.rechargePolicyId":function(e){for(var r=this,a=0,c=r.rechargePolicyList.length;a<c;a++)if(r.rechargePolicyList[a].rechargePolicyId==e){r.canModify=r.rechargePolicyList[a].canModify,r.isShowCash=!!r.canModify,r.paramInfo.rechargePolicyId=r.rechargePolicyList[a].rechargePolicyId,r.rechargeInfo.rechargePolicyId=r.rechargePolicyList[a].rechargePolicyId;break}}},methods:{setIsCanModify:function(e,r){var a=this;a.rechargeInfo.rechargePolicyId=e,a.isShowCash=!!r},getRechargePolicy:function(){var e=this;utility.interactWithServer({headerInfo:{userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.walletService,CONFIG.ACTION.getRechargePolicy,{action:CONFIG.ACTION.getRechargePolicy})},url:CONFIG.HOST+CONFIG.SERVICE.walletService,dataObj:{action:CONFIG.ACTION.getRechargePolicy},beforeSendCallback:function(){app.showIndicator()},completeCallback:function(e,r){app.hideIndicator()},successCallback:function(r){if(200==r.code){e.rechargePolicyList=r.data;for(var a=0,c=e.rechargePolicyList.length;a<c;a++)if(1==e.rechargePolicyList[a].canModify){e.paramInfo.rechargePolicyId=e.rechargePolicyList[a].rechargePolicyId,e.rechargeInfo.rechargePolicyId=e.rechargePolicyList[a].rechargePolicyId;break}}else app.showPreloader(r.message),setTimeout(function(){app.hidePreloader()},1e3)}})},doRechargeAction:function(){var e=this;return 1==e.canModify&&0==e.rechargeInfo.rechargeMoney?(app.showPreloader("充值金额不能为0"),void setTimeout(function(){app.hidePreloader()},1e3)):(e.rechargeInfo.remark=encodeURIComponent(e.remark),e.paramInfo.rechargeMoney=e.rechargeInfo.rechargeMoney,e.paramInfo.rechargePolicyId=e.rechargeInfo.rechargePolicyId,e.paramInfo.remark=e.rechargeInfo.remark,e.rechargeInfo.backUrl=CONFIG.HOST+"/app/app.html#page//app/view/order/result.html?paramInfo="+encodeURI(JSON.stringify(e.paramInfo)),void(window.location.href=CONFIG.HOST+utility.formatActionUrl(CONFIG.SERVICE.walletService,CONFIG.ACTION.userRrecharge,e.rechargeInfo,!0)+"&userId="+USERINFO.userId+"&userToken="+USERINFO.userToken+"&appType=1"))}},created:function(){var e=this;e.getRechargePolicy(),PAGE.query.code&&200!=PAGE.query.code&&(app.showPreloader(PAGE.query.message),setTimeout(function(){app.hidePreloader()},1e3))}})})();