(function(){new Vue({el:"#js-buyDlt",data:{userInfo:USERINFO,offTime:"",currentIssueName:"",buyInfo:{action:CONFIG.ACTION.previewOrder,type:0,lotteryTypeId:"14",issueNo:"",digitalBetType:1,dBetFunction:1,betDetail:"",extraAdd:0,multipleNum:1,followFlag:0,followIssueNum:"",followStopFor:0},isCheck:!0,betNum:0,betMoney:0,redBetList:[],blueBetList:[],redDAreaList:[],blueDAreaList:[],resultList:[],digitalData:null,digitalList:[],orderInfoDetail:{},isShowTypeSelect:!1,isShowMenu:!1,randomRed:5,randomBlue:2},watch:{"buyInfo.dBetFunction":function(t){var e=this;e.redBetList=[],e.blueBetList=[],e.redDAreaList=[]},"buyInfo.multipleNum":function(t){var e=this;t<=0&&(e.buyInfo.multipleNum=1),e.resultList.length>0&&t>0&&e.setOrderInfo()},redDAreaList:function(t){var e=this;t.length>5&&(e.redDAreaList=t.slice(0,t.length-1))},blueDAreaList:function(t){var e=this;t.length>1&&(e.blueDAreaList=t.slice(0,t.length-1))},"buyInfo.followFlag":function(t){var e=this;0==t?e.buyInfo.followIssueNum="":1==t&&(e.buyInfo.followIssueNum=e.buyInfo.issueNo)}},methods:{userLogout:function(){utility.userLogout(function(){window.location.replace(CONFIG.HOST+"/www/index.html")})},addMultipleNum:function(){var t=this;t.buyInfo.multipleNum=t.buyInfo.multipleNum+1},reduceMultipleNum:function(){var t=this;t.buyInfo.multipleNum=t.buyInfo.multipleNum-1},clearAll:function(){var t=this;t.emptySelect(),t.resultList=[],t.orderInfoDetail={},t.betNum=0,t.betMoney=0,utility.setSessionStorage("resultList",null),utility.setSessionStorage("orderInfo",null)},emptySelect:function(){var t=this;t.redBetList=[],t.blueBetList=[],t.redDAreaList=[],t.blueDAreaList=[]},randomBuyTime:function(t){for(var e=this,i=0;i<t;i++)(function(t){var i=utility.genreateArr(35),r=utility.genreateArr(12),u=utility.getArrByNum(i,5,0),n=utility.getArrByNum(r,2,0);e.buyInfo.dBetFunction=1,e.redBetList=u.sort(function(t,e){return t-e}),e.blueBetList=n.sort(function(t,e){return t-e}),e.addToResult()})(i)},randomBallNum:function(t,e){var i=this,r=utility.genreateArr(35),u=utility.genreateArr(12);"isRed"==t?i.redBetList=utility.getArrByNum(r,e,0):"isBlue"==t&&(i.blueBetList=utility.getArrByNum(u,e,0))},deleteDArea:function(t,e){for(var i=this,r=0,u=i[t].length;r<u;r++)i[e].indexOf(i[t][r])>=0&&i[e].splice(i[e].indexOf(i[t][r]),1)},validate:function(){var t=this;if(1==t.buyInfo.dBetFunction){if(t.redBetList.length<5)return alert("必须选择5个以上红球"),!1;if(t.blueBetList.length<2)return alert("必须选择2个以上蓝球"),!1}if(2==t.buyInfo.dBetFunction){if(t.redBetList.length<6)return alert("必须选择6个以上红球"),!1;if(t.blueBetList.length<2)return alert("必须选择2个以上蓝球"),!1}},addToResult:function(){var t=this;0!=t.validate()&&(t.resultList.push({redBetList:t.redBetList.sort(function(t,e){return t-e}),blueBetList:t.blueBetList.sort(function(t,e){return t-e}),redDAreaList:t.redDAreaList.sort(function(t,e){return t-e})}),t.emptySelect(),utility.setSessionStorage("resultList",t.resultList),t.setOrderInfo())},deleteResult:function(t){var e=this;e.resultList.splice(t,1),e.orderInfoDetail.digitalOrderItems.splice(t,1),utility.setSessionStorage("resultList",e.resultList),0==e.resultList.length?(e.betNum=0,e.betMoney=0):e.setOrderInfo()},getPrizeList:function(){var t=this;utility.getDigitalPrizeData({appType:"2",lottoId:t.buyInfo.lotteryTypeId,fetchNum:100,callback:function(e){t.digitalList=e.data,t.digitalData=e.data[0]}})},getDigitalIssue:function(){var t=this;utility.getDigitalIssue({lottoId:t.buyInfo.lotteryTypeId,appType:2,callback:function(e){t.buyInfo.issueNo=e.data[0].currentIssueNo,t.currentIssueName=e.data[0].currentIssueName,t.offTime=e.data[0].offTime,t.getPrizeList()}})},setOrderInfo:function(){var t=this;utility.setDigitalOrderInfo(t,t.buyInfo.lotteryTypeId,"大乐透",function(e,i){return t.buyInfo.digitalBetType+"|"+t.buyInfo.dBetFunction+"|"+(0==t.resultList[i].redDAreaList.length?"":t.resultList[i].redDAreaList.join(","))+"|"+utility.duplicate(t.resultList[i].redBetList,t.resultList[i].redDAreaList).join(",")+"||"+t.resultList[i].blueBetList.join(",")},function(){var e=utility.getSessionStorage("orderInfo");utility.previewOrder({appType:"2",service:CONFIG.SERVICE.dOrderService,params:e.buyInfo,callback:function(e){t.orderInfoDetail=e,t.betNum=e.totalBetsNum,t.betMoney=e.totalOrderPrice}})})},generateOrder:function(){var t=this;return 0==t.resultList.length?(alert("投注不能为空"),!1):void utility.generateOrder({appType:"2",service:CONFIG.SERVICE.dOrderService,callback:function(t){window.location.href=CONFIG.HOST+"/www/view/order/pay.html"}})},init:function(){var t=this;utility.getSessionStorage("orderInfo")&&utility.getSessionStorage("orderInfo").buyInfo.lotteryTypeId!=t.buyInfo.lotteryTypeId&&(utility.setSessionStorage("resultList",null),utility.setSessionStorage("orderInfo",null),utility.setSessionStorage("generateOrder",null)),utility.getSessionStorage("orderInfo")&&(t.buyInfo=utility.getSessionStorage("orderInfo").buyInfo),utility.getSessionStorage("resultList")&&(t.resultList=utility.getSessionStorage("resultList"),t.resultList.length>0&&t.setOrderInfo()),t.getDigitalIssue()}},created:function(){var t=this;t.init()}})})();