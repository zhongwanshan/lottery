(function(){new Vue({el:"#js-pageBuyBasketball",data:{userInfo:USERINFO,matchList:[],matchData:null,matchInfoObj:null,totalOrderPrice:0,selectItem:{num:0},buyInfo:{action:CONFIG.ACTION.previewOrder,lotteryTypeId:"1004",issueNo:"",type:0,betDetail:"",multipleNum:1},cgDetail:"CG_2_1",cgList:["2串1"],cgInfo:CONFIG.CG,winList:[{name:"1-5分",value:"h0105"},{name:"6-10分",value:"h0610"},{name:"11-15分",value:"h1115"},{name:"16-20分",value:"h1620"},{name:"21-25分",value:"h2125"},{name:"26+",value:"h2600"}],loseList:[{name:"1-5分",value:"c0105"},{name:"6-10分",value:"c0610"},{name:"11-15分",value:"c1115"},{name:"16-20分",value:"c1620"},{name:"21-25分",value:"c2125"},{name:"26+",value:"c2600"}],isShowMenu:!1},watch:{cgList:function(t){for(var e=this,n=[],a=0,i=t.length;a<i;a++)n.push(e.cgInfo[t[a]]);e.cgDetail=n.join(","),e.cgList.length>0&&e.countSelectItem(e.matchInfoObj)},"buyInfo.multipleNum":function(t){var e=this;t<=0&&(e.buyInfo.multipleNum=1),e.cgList.length>0&&e.countSelectItem(e.matchInfoObj)}},methods:{userLogout:function(){utility.userLogout(function(){window.location.replace(CONFIG.HOST+"/www/index.html")})},setCheckBox:function(t){for(var e=[],n=0,a=t.length;n<a;n++)(function(n){t[n].isShow=!1,t[n].matchInfo={sf:[],rang:[],score:[],win:[],lose:[]},e.push(t[n])})(n);return e},formatMatchData:function(){for(var t=this,e={},n=0,a=t.matchList.length;n<a;n++)(function(n){var a=t.matchList[n].dtime.split(" ")[0];e[a]={list:[],weekDay:"",time:""}})(n);for(var i in e)if(e.hasOwnProperty(i))for(var o=0,r=t.matchList.length;o<r;o++)(function(n){var a=t.matchList[n].dtime,o=a.split(" ")[0],r=utility.getCurrentTimeInfo(o);i==o&&(e[i].list.push(t.matchList[n]),e[i].weekDay=r.weekDay,e[i].time=o)})(o);t.matchInfoObj=e},geBkBlendMatches:function(){var t=this;utility.geBkBlendMatches({matchDay:"",type:2,callback:function(e){t.matchList=t.setCheckBox(e.data),t.formatMatchData()}})},getCheckResult:function(t){for(var e=[],n=0,a=t.length;n<a;n++)e.push(t[n].split(",")[3]);return e.join(",")},reFormatMatch:function(t){for(var e=[],n=0,a=t.length;n<a;n++)e.push(n+1+"|"+t[n]);return e.join("#")},countSelectItem:function(t){var e=this,n=0,a="",i=[];for(var o in t)if(t.hasOwnProperty(o))for(var r=0,l=t[o].list.length;r<l;r++){var c=t[o].list[r],u=c.matchInfo,s=u.sf,h=u.rang,f=u.score,m=u.win,g=u.lose,I=s.length,v=h.length,y=f.length,d=m.length,p=g.length;I+v+y+d+p>0&&(n++,i.push(c.mid+"|"+c.num+"|"+(s.length>0?e.getCheckResult(s):"")+(h.length>0?","+e.getCheckResult(h):"")+(f.length>0?","+e.getCheckResult(f):"")+(m.length>0?","+e.getCheckResult(m):"")+(g.length>0?e.getCheckResult(g):"")))}a=e.reFormatMatch(i)+(e.cgDetail.length>0?"%"+e.cgDetail:""),e.buyInfo.betDetail=a,e.selectItem.num=n,e.setOrderInfo()},setOrderInfo:function(){var t=this;t.selectItem.num>1&&utility.previewOrder({appType:"2",service:CONFIG.SERVICE.bOrderService,params:t.buyInfo,callback:function(e){utility.setSessionStorage("orderInfo",{buyInfo:t.buyInfo}),utility.setSessionStorage("resultList",e.matchList),t.totalOrderPrice=e.totalOrderPrice}})},generateOrder:function(){var t=this;return t.selectItem.num<=1?void alert("请至少选择两场球赛"):void utility.generateOrder({appType:"2",service:CONFIG.SERVICE.bOrderService,callback:function(t){window.location.href=CONFIG.HOST+"/www/view/order/pay.html"}})}},created:function(){var t=this;t.geBkBlendMatches(),t.$watch("matchInfoObj",function(e,n){t.countSelectItem(e)},{deep:!0}),utility.getSessionStorage("orderInfo")&&utility.getSessionStorage("orderInfo").buyInfo.lotteryTypeId!=t.buyInfo.lotteryTypeId&&(utility.setSessionStorage("resultList",null),utility.setSessionStorage("orderInfo",null),utility.setSessionStorage("generateOrder",null))}})})();