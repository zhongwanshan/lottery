(function(){new Vue({el:"#js-pageBuyFootball",data:{matchList:[],matchData:null,matchInfoObj:null,totalOrderPrice:0,selectItem:{num:0},buyInfo:{action:CONFIG.ACTION.previewOrder,lotteryTypeId:"1001",issueNo:"",type:0,betDetail:"",multipleNum:1},cgDetail:"CG_2_1",cgList:["2串1"],cgInfo:CONFIG.CG,sfList:[{name:"胜",value:"s"},{name:"平",value:"p"},{name:"负",value:"f"}],rangList:[{name:"胜",value:"rang_s"},{name:"平",value:"rang_p"},{name:"负",value:"rang_f"}],scoreSList:[{name:"1:0",value:"vs10"},{name:"2:0",value:"vs20"},{name:"2:1",value:"vs21"},{name:"3:0",value:"vs30"},{name:"3:1",value:"vs31"},{name:"3:2",value:"vs32"},{name:"4:0",value:"vs40"},{name:"4:1",value:"vs41"},{name:"4:2",value:"vs42"},{name:"5:0",value:"vs50"},{name:"5:1",value:"vs51"},{name:"5:2",value:"vs52"},{name:"胜其它",value:"vsmore_s"}],scorePList:[{name:"0:0",value:"vs00"},{name:"1:1",value:"vs11"},{name:"2:2",value:"vs22"},{name:"3:3",value:"vs33"},{name:"平其它",value:"vsmore_p"}],scoreFList:[{name:"0:1",value:"vs01"},{name:"0:2",value:"vs02"},{name:"1:2",value:"vs12"},{name:"0:3",value:"vs03"},{name:"1:3",value:"vs13"},{name:"2:3",value:"vs23"},{name:"0:4",value:"vs04"},{name:"1:4",value:"vs14"},{name:"2:4",value:"vs24"},{name:"0:5",value:"vs05"},{name:"1:5",value:"vs15"},{name:"2:5",value:"vs25"},{name:"负其它",value:"vsmore_f"}],ballList:[{name:"0球",value:"g0"},{name:"2球",value:"g2"},{name:"3球",value:"g3"},{name:"4球",value:"g4"},{name:"6球",value:"g6"},{name:"7球以上",value:"g7"}],halfList:[{name:"胜/胜",value:"ss"},{name:"胜/平",value:"sp"},{name:"胜/负",value:"sf"},{name:"平/平",value:"pp"},{name:"平/负",value:"pf"},{name:"负/胜",value:"fs"},{name:"负/平",value:"fp"},{name:"负/负",value:"ff"}],isShowMenu:!1,weekList:{w_1:"星期一",w_2:"星期二",w_3:"星期三",w_4:"星期四",w_5:"星期五",w_6:"星期六",w_7:"星期日"}},watch:{cgList:function(e){for(var a=this,t=[],n=0,l=e.length;n<l;n++)t.push(a.cgInfo[e[n]]);a.cgDetail=t.join(","),a.countSelectItem(a.matchInfoObj)},"buyInfo.multipleNum":function(e){var a=this;e<=0&&(a.buyInfo.multipleNum=1),a.cgList.length>0&&a.countSelectItem(a.matchInfoObj)}},methods:{showMenu:function(){var e=this;e.isShowMenu=!e.isShowMenu},setCheckBox:function(e){for(var a=[],t=0,n=e.length;t<n;t++)(function(t){e[t].matchInfo={sf:[],rang:[],score:[],ball:[],half:[]},a.push(e[t])})(t);return a},formatMatchData:function(){for(var e=this,a={},t=0,n=e.matchList.length;t<n;t++)(function(t){var n=e.matchList[t].dtime.split(" ")[0];a[n]={list:[],weekDay:"",time:""}})(t);for(var l in a)if(a.hasOwnProperty(l))for(var u=0,s=e.matchList.length;u<s;u++)(function(t){var n=e.matchList[t].dtime,u=n.split(" ")[0],s=utility.getCurrentTimeInfo(u);l==u&&(a[l].list.push(e.matchList[t]),a[l].weekDay=s.weekDay,a[l].time=u)})(u);e.matchInfoObj=a},geFbBlendMatches:function(){var e=this;utility.interactWithServer({headerInfo:{userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.lotteryService,CONFIG.ACTION.geFbBlendMatches,{action:CONFIG.ACTION.geFbBlendMatches})},url:CONFIG.HOST+CONFIG.SERVICE.lotteryService,dataObj:{action:CONFIG.ACTION.geFbBlendMatches},successCallback:function(a){200==a.code&&(e.matchList=e.setCheckBox(a.data),e.formatMatchData(),utility.setiScroll("page"+PAGE.name))}})},showPopupAndSetData:function(e,a){var t=this;t.matchData={key:e,index:a,data:t.matchInfoObj[e].list[a]},app.popup(".popup-setData")},getCheckResult:function(e){for(var a=[],t=0,n=e.length;t<n;t++)a.push(e[t].split(",")[3]);return a.join(",")},reFormatMatch:function(e){for(var a=[],t=0,n=e.length;t<n;t++)a.push(t+1+"|"+e[t]);return a.join("#")},countSelectItem:function(e){var a=this,t=0,n="",l=[];for(var u in e)if(e.hasOwnProperty(u))for(var s=0,i=e[u].list.length;s<i;s++){var r=e[u].list[s],o=r.matchInfo,v=o.sf,c=o.rang,m=o.score,h=o.ball,f=o.half,g=v.length,I=c.length,p=m.length,d=h.length,O=f.length;g+I+p+d+O>0&&(t++,l.push(r.mid+"|"+r.num+"|"+(v.length>0?a.getCheckResult(v):"")+(c.length>0?","+a.getCheckResult(c):"")+(m.length>0?","+a.getCheckResult(m):"")+(h.length>0?","+a.getCheckResult(h):"")+(f.length>0?a.getCheckResult(f):"")))}n=a.reFormatMatch(l)+(a.cgDetail.length>0?"%"+a.cgDetail:""),a.buyInfo.betDetail=n,a.selectItem.num=t,a.setOrderInfo()},setOrderInfo:function(){var e=this;e.selectItem.num>1&&utility.previewOrder({service:CONFIG.SERVICE.bOrderService,params:e.buyInfo,callback:function(a){utility.setSessionStorage("orderInfo",{buyInfo:e.buyInfo}),e.totalOrderPrice=a.totalOrderPrice}})},generateOrder:function(){var e=this;return e.selectItem.num<=1?(app.showPreloader("请至少选择两场球赛"),setTimeout(function(){app.hidePreloader()},1e3),!1):void utility.generateOrder({service:CONFIG.SERVICE.bOrderService,callback:function(e){mainView.router.loadPage("view/order/pay.html")}})}},created:function(){var e=this;e.geFbBlendMatches(),e.$watch("matchInfoObj",function(a,t){e.countSelectItem(a)},{deep:!0}),$("body").find(".js-showMenu").on("click",function(){e.isShowMenu=!e.isShowMenu})}})})();