(function(){new Vue({el:"#js-pageRs9",data:{matchData:[],matchList:[],matchInfoObj:null,numList:[],num:"",matchNum:0,betNum:0,selectItem:{num:0},buyInfo:{action:CONFIG.ACTION.previewOrder,lotteryTypeId:"1003",issueNo:"",type:0,betDetail:"",multipleNum:1},isShowMenu:!1},watch:{num:function(t){var e=this;e.matchData=e.matchInfoObj[t]},"buyInfo.multipleNum":function(t){var e=this;t<=0&&(e.buyInfo.multipleNum=1),e.selectItem.num>=9&&e.setOrderInfo()}},methods:{showMenu:function(){var t=this;t.isShowMenu=!t.isShowMenu},setCheckBox:function(t){for(var e=[],n=0,a=t.length;n<a;n++)(function(n){t[n].matchInfo={sf:[]},e.push(t[n])})(n);return e},formatMatchData:function(){for(var t=this,e=[],n={},a=0,i=t.matchList.length;a<i;a++)(function(a){var i=t.matchList[a].num;e.push(i),n[i]=[]})(a);t.numList=$.unique(e),t.num=t.numList[0],t.buyInfo.issueNo=t.numList[0];for(var r in n)if(n.hasOwnProperty(r))for(var o=0,u=t.matchList.length;o<u;o++)(function(e){var a=t.matchList[e].num;r==a&&n[r].push(t.matchList[e])})(o);t.matchInfoObj=n},geFbTraditionMatches:function(){var t=this;utility.interactWithServer({headerInfo:{userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.lotteryService,CONFIG.ACTION.geFbTraditionMatches,{action:CONFIG.ACTION.geFbTraditionMatches})},url:CONFIG.HOST+CONFIG.SERVICE.lotteryService,dataObj:{action:CONFIG.ACTION.geFbTraditionMatches},successCallback:function(e){200==e.code&&(t.matchList=t.setCheckBox(e.data||[]),t.formatMatchData(),t.matchData=t.matchInfoObj[t.num],utility.setiScroll("page"+PAGE.name))}})},bindClickEvent:function(t){var e=this;setTimeout(function(){for(var t=0,n=1,a=[],i=0,r=e.matchData.length;i<r;i++)e.matchData[i].matchInfo.sf.length>0&&t++,0!==e.matchData[i].matchInfo.sf.length&&a.push(e.matchData[i].matchInfo.sf.length*n);if(a.length>=9){for(var o=0,u=a.length;o<u;o++)n*=a[o];e.betNum=n}else e.betNum=0;e.matchNum=t},500)},getCheckResult:function(t){for(var e=[],n=0,a=t.length;n<a;n++)e.push(t[n].split(","));return e.join(",")},reFormatMatch:function(t){for(var e=[],n=0,a=t.length;n<a;n++)e.push(n+1+"|"+t[n]);return e.join("#")},countSelectItem:function(t){var e=this,n=0,a="",i=[];for(var r in t)if(t.hasOwnProperty(r))for(var o=0,u=t[r].length;o<u;o++){var c=t[r][o],s=c.matchInfo,h=s.sf,m=h.length;m>0&&(n++,i.push(c.lottoid+"|"+c.num+"|"+(m>0?e.getCheckResult(h):"")))}a=e.reFormatMatch(i)+"%CG_9_1",e.buyInfo.betDetail=a,e.selectItem.num=n,e.setOrderInfo()},setOrderInfo:function(){var t=this;t.selectItem.num>=9&&utility.previewOrder({service:CONFIG.SERVICE.bOrderService,params:t.buyInfo,callback:function(e){utility.setSessionStorage("orderInfo",{buyInfo:t.buyInfo}),utility.setSessionStorage("resultList",e.matchList),t.totalOrderPrice=e.totalOrderPrice}})},generateOrder:function(){var t=this;return t.selectItem.num<9?(app.showPreloader("请选择9场球赛"),setTimeout(function(){app.hidePreloader()},1e3),!1):void utility.generateOrder({service:CONFIG.SERVICE.bOrderService,callback:function(t){mainView.router.loadPage("view/order/pay.html")}})}},created:function(){var t=this;t.geFbTraditionMatches(),t.$watch("matchInfoObj",function(e,n){t.countSelectItem(e)},{deep:!0}),$("body").find(".js-showMenu").on("click",function(){t.isShowMenu=!t.isShowMenu})}})})();