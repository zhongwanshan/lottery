(function(){new Vue({el:"#js-pageDeposit",data:{userInfo:USERINFO,isAction:!1,showAddList:!1,allCarList:[],myCarList:[],bindCarInfo:{bankId:"",bankName:"",cardNo:"",bankAccountName:"",subBankName:"",action:CONFIG.ACTION.bindBankCard,payPwd:""},payPwd:"",amount:"",depositInfo:{amount:"",action:CONFIG.ACTION.userWithdrawCash,remark:"",payPwd:"",bindBankCardId:""},depositPwd:"",remark:"",defaultBankId:""},watch:{"bindCarInfo.bankId":function(t){for(var e=this,a=0,i=e.allCarList.length;a<i;a++)if(e.allCarList[a].bankId==t){e.bindCarInfo.bankName=encodeURIComponent(e.allCarList[a].bankName);break}}},methods:{userLogout:function(){utility.userLogout(function(){window.location.replace(CONFIG.HOST+"/www/index.html")})},getAllBankList:function(){var t=this;utility.interactWithServer({headerInfo:{appType:"2",userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:""},url:CONFIG.HOST+CONFIG.SERVICE.getBankList,successCallback:function(e){200==e.code&&(t.allCarList=e.data)}})},bindBankCard:function(){var t=this;if(1!=t.isAction){if(utility.checkLen(t.bindCarInfo.bankId,0))return void alert("请选择一张银行卡");if(utility.checkLen(t.bindCarInfo.cardNo,0))return void alert("请输入银行卡号");if(utility.checkLen(t.bindCarInfo.bankAccountName,0))return void alert("请输入开户人");if(utility.checkLen(t.bindCarInfo.subBankName,0))return void alert("请输入开户行");if(utility.checkLen(t.payPwd,0))return void alert("请输入支付密码");t.bindCarInfo.payPwd=md5(t.payPwd).toUpperCase(),utility.interactWithServer({headerInfo:{userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.walletService,CONFIG.ACTION.bindBankCard,t.bindCarInfo)},url:CONFIG.HOST+CONFIG.SERVICE.walletService,dataObj:t.bindCarInfo,completeCallback:function(e,a){t.isAction=!1},successCallback:function(e){200==e.code?(t.getUserBindCardList(),t.showAddList=!1):alert(e.message)}})}},isShowAddList:function(t){var e=this;e.showAddList=t},getUserBindCardList:function(){var t=this;utility.interactWithServer({headerInfo:{userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.walletService,CONFIG.ACTION.getUserBankCards,{action:CONFIG.ACTION.getUserBankCards})},url:CONFIG.HOST+CONFIG.SERVICE.walletService,dataObj:{action:CONFIG.ACTION.getUserBankCards},successCallback:function(e){if(200==e.code){t.myCarList=e.data;for(var a=0,i=t.myCarList.length;a<i;a++)if(1==t.myCarList[a].isDefault){t.depositInfo.bindBankCardId=t.myCarList[a].bindBankCardId;break}}}})},setDefaultBankCard:function(t){var e=this;utility.interactWithServer({headerInfo:{userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.walletService,CONFIG.ACTION.setDefaultBankCard,{action:CONFIG.ACTION.setDefaultBankCard,bindBankCardId:t})},url:CONFIG.HOST+CONFIG.SERVICE.walletService,dataObj:{action:CONFIG.ACTION.setDefaultBankCard,bindBankCardId:t},successCallback:function(t){200==t.code&&e.getUserBindCardList()}})},depositAction:function(){var t=this;if(1!=t.isAction){if(utility.checkLen(t.depositInfo.bindBankCardId,0))return void alert("请选择一张银行卡");if(utility.checkLen(t.amount,0))return void alert("请输入提现金额");if(utility.checkLen(t.depositPwd,0))return void alert("请输入支付密码");t.depositInfo.amount=100*t.amount,t.depositInfo.payPwd=md5(t.depositPwd).toUpperCase(),t.depositInfo.remark=encodeURIComponent(t.remark),utility.interactWithServer({headerInfo:{userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.walletService,CONFIG.ACTION.userWithdrawCash,t.depositInfo)},url:CONFIG.HOST+CONFIG.SERVICE.walletService,dataObj:t.depositInfo,completeCallback:function(e,a){t.isAction=!1},successCallback:function(t){200==t.code||alert(t.message)}})}}},created:function(){var t=this;t.getUserBindCardList(),t.getAllBankList()}})})();