var app=new Framework7({pushState:!0,pushStateSeparator:"#page/",onAjaxStart:function(e){app.showIndicator()},onAjaxComplete:function(e){app.hideIndicator()}}),$=Dom7,mainView=app.addView(".view-main",{dynamicNavbar:!0,animatePages:!1});mainView.router.loadPage("cashier.html"),$(document).on("pageInit",function(e){var a=utility.getQueryParams(),t=utility.getLocalStorage("userInfo");new Vue({el:"#js-cashier",data:{payChannelId:"",amount:"",payPwd:"",walletLeftCash:0,payChannelList:[]},watch:{payChannelId:function(e){for(var a=this,t=0,n=a.payChannelList.length;t<n;t++)if("wallet"==a.payChannelList[t].payChannelId){a.walletLeftCash=a.payChannelList[t].walletLeftCash;break}}},methods:{setPayChannelId:function(e){var a=this;a.payChannelId=e},getPayChannel:function(){var e=this;utility.interactWithServer({headerInfo:{appType:a.appType,userId:t?t.userId:"",userToken:t?t.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.walletService,CONFIG.ACTION.getPayChannel,{action:CONFIG.ACTION.getPayChannel,orderCode:a.orderCode,payFlag:a.payFlag})},url:CONFIG.HOST+CONFIG.SERVICE.walletService,dataObj:{action:CONFIG.ACTION.getPayChannel,orderCode:a.orderCode,payFlag:a.payFlag},beforeSendCallback:function(){app.showIndicator()},completeCallback:function(e,a){app.hideIndicator()},successCallback:function(a){200==a.code?(e.payChannelList=a.data,e.amount=e.payChannelList[0].amount):(app.showPreloader(a.message),setTimeout(function(){app.hidePreloader()},1e3))}})},payAction:function(){var e=this;if(utility.checkLen(e.payChannelId,0))return app.showPreloader("请选择一种支付方式"),void setTimeout(function(){app.hidePreloader()},1e3);if("wallet"==e.payChannelId){if(e.walletLeftCash<a.amount)return app.showPreloader("钱包余额不足!"),void setTimeout(function(){app.hidePreloader()},1e3);if(0==e.payPwd.length)return app.showPreloader("请输入支付密码"),void setTimeout(function(){app.hidePreloader()},1e3)}window.location.href=CONFIG.HOST+utility.formatActionUrl(CONFIG.SERVICE.walletService,CONFIG.ACTION.getPay,{action:CONFIG.ACTION.getPay,payChannelId:e.payChannelId,orderCode:a.orderCode,payPwd:md5(e.payPwd).toUpperCase()})+"&userId="+t.userId+"&userToken="+t.userToken+"&appType="+a.appType+"&orderCode="+t.orderCode}},created:function(){var e=this;e.getPayChannel()}})});