(function(){new Vue({el:"#js-buyDlt",data:{offTime:"",currentIssueName:"",buyInfo:{action:CONFIG.ACTION.previewOrder,type:0,lotteryTypeId:"14",issueNo:"",digitalBetType:1,dBetFunction:1,betDetail:"",extraAdd:0,multipleNum:1,followFlag:0,followIssueNum:"",followStopFor:0},isCheck:!0,dBetFunText:CONFIG.DBETFUNCTION.d_1,betNum:0,betMoney:0,redBetList:[],blueBetList:[],redDAreaList:[],blueDAreaList:[],resultList:[],orderInfoDetail:{},isShowTypeSelect:!1,isShowMenu:!1},watch:{"buyInfo.dBetFunction":function(e){var t=this;t.dBetFunText=CONFIG.DBETFUNCTION["d_"+e],t.redBetList=[],t.blueBetList=[],t.redDAreaList=[],utility.setiScroll()},"buyInfo.digitalBetType":function(e){utility.setiScroll()},"buyInfo.multipleNum":function(e){var t=this;e<0&&(t.buyInfo.multipleNum=1),t.resultList.length>0&&e>0&&t.setOrderInfo()},redDAreaList:function(e){var t=this;e.length>5&&(t.redDAreaList=e.slice(0,e.length-1))},blueDAreaList:function(e){var t=this;e.length>1&&(t.blueDAreaList=e.slice(0,e.length-1))},"buyInfo.followFlag":function(e){var t=this;0==e?t.buyInfo.followIssueNum="":1==e&&(t.buyInfo.followIssueNum=t.buyInfo.issueNo)}},methods:{showTypeSelect:function(){var e=this;e.isShowTypeSelect=!e.isShowTypeSelect},showMenu:function(){var e=this;e.isShowMenu=!e.isShowMenu},clearAll:function(){var e=this;e.emptySelect(),e.resultList=[],e.orderInfoDetail={},e.betNum=0,e.betMoney=0,utility.setSessionStorage("resultList",null),utility.setSessionStorage("orderInfo",null),utility.setiScroll()},emptySelect:function(){var e=this;e.redBetList=[],e.blueBetList=[],e.redDAreaList=[],e.blueDAreaList=[]},randomBuyTime:function(e){for(var t=this,i=0;i<e;i++)(function(e){setTimeout(function(){var e=utility.genreateArr(35),i=utility.genreateArr(12),r=utility.getArrByNum(e,5,0),s=utility.getArrByNum(i,2,0);t.buyInfo.dBetFunction=1,t.redBetList=r.sort(function(e,t){return e-t}),t.blueBetList=s.sort(function(e,t){return e-t}),t.addToResult()},500)})(i)},deleteDArea:function(e,t){for(var i=this,r=0,s=i[e].length;r<s;r++)i[t].indexOf(i[e][r])>=0&&i[t].splice(i[t].indexOf(i[e][r]),1)},validate:function(){var e=this;if(1==e.buyInfo.dBetFunction){if(e.redBetList.length<5)return app.showPreloader("必须选择5个以上红球"),setTimeout(function(){app.hidePreloader()},1e3),!1;if(e.blueBetList.length<2)return app.showPreloader("必须选择2个以上蓝球"),setTimeout(function(){app.hidePreloader()},1e3),!1}if(2==e.buyInfo.dBetFunction){if(e.redBetList.length<6)return app.showPreloader("必须选择6个以上红球"),setTimeout(function(){app.hidePreloader()},1e3),!1;if(e.blueBetList.length<2)return app.showPreloader("必须选择2个以上蓝球"),setTimeout(function(){app.hidePreloader()},1e3),!1}return!0},addToResult:function(){var e=this;0!=e.validate()&&(e.resultList.push({digitalBetType:e.buyInfo.digitalBetType,dBetFunction:e.buyInfo.dBetFunction,redBetList:e.redBetList.sort(function(e,t){return e-t}),blueBetList:e.blueBetList.sort(function(e,t){return e-t}),redDAreaList:e.redDAreaList.sort(function(e,t){return e-t})}),e.emptySelect(),utility.setSessionStorage("resultList",e.resultList),utility.setiScroll(),e.setOrderInfo())},deleteResult:function(e){var t=this;t.resultList.splice(e,1),t.orderInfoDetail.digitalOrderItems.splice(e,1),utility.setSessionStorage("resultList",t.resultList),0==t.resultList.length?(t.betNum=0,t.betMoney=0):t.setOrderInfo()},getDigitalIssue:function(){var e=this;utility.getDigitalIssue({lottoId:e.buyInfo.lotteryTypeId,appType:1,callback:function(t){e.buyInfo.issueNo=t.data[0].currentIssueNo,e.currentIssueName=t.data[0].currentIssueName,e.offTime=t.data[0].offTime}})},setOrderInfo:function(){var e=this;utility.setDigitalOrderInfo(e,e.buyInfo.lotteryTypeId,"大乐透",function(t,i){return e.resultList[i].digitalBetType+"|"+e.resultList[i].dBetFunction+"|"+(0==e.resultList[i].redDAreaList.length?"":e.resultList[i].redDAreaList.join(","))+"|"+utility.duplicate(e.resultList[i].redBetList,e.resultList[i].redDAreaList).join(",")+"||"+e.resultList[i].blueBetList.join(",")},function(){var t=utility.getSessionStorage("orderInfo");utility.previewOrder({service:CONFIG.SERVICE.dOrderService,params:t.buyInfo,callback:function(t){e.orderInfoDetail=t,e.betNum=t.totalBetsNum,e.betMoney=t.totalOrderPrice}})})},generateOrder:function(){var e=this;return 0==e.resultList.length?(app.showPreloader("投注不能为空"),setTimeout(function(){app.hidePreloader()},1e3),!1):void utility.generateOrder({service:CONFIG.SERVICE.dOrderService,callback:function(e){mainView.router.loadPage("/app/view/order/pay.html")}})},init:function(){var e=this;utility.getSessionStorage("orderInfo")&&(utility.getSessionStorage("orderInfo").buyInfo.lotteryTypeId!=e.buyInfo.lotteryTypeId?(utility.setSessionStorage("resultList",null),utility.setSessionStorage("orderInfo",null),utility.setSessionStorage("generateOrder",null)):e.buyInfo=utility.getSessionStorage("orderInfo").buyInfo),utility.getSessionStorage("resultList")&&(e.resultList=utility.getSessionStorage("resultList"),e.resultList.length>0&&e.setOrderInfo()),e.getDigitalIssue()}},created:function(){var e=this;e.init(),$("body").find(".js-showMenu").on("click",function(){e.isShowMenu=!e.isShowMenu})}})})();