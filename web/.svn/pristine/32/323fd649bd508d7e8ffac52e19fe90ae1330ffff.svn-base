(function(){new Vue({el:"#js-pageDeposit",data:{isAction:!1,allCarList:[],myCarList:[],bindCarInfo:{bankId:"",bankName:"",cardNo:"",bankAccountName:"",subBankName:"",action:CONFIG.ACTION.bindBankCard,payPwd:""},payPwd:"",amount:"",depositInfo:{amount:"",action:CONFIG.ACTION.userWithdrawCash,remark:"",payPwd:"",bindBankCardId:""},depositPwd:"",remark:"",defaultBankId:""},watch:{"bindCarInfo.bankId":function(e){for(var a=this,t=0,i=a.allCarList.length;t<i;t++)if(a.allCarList[t].bankId==e){a.bindCarInfo.bankName=encodeURIComponent(a.allCarList[t].bankName);break}}},methods:{getAllBankList:function(){var e=this;utility.interactWithServer({headerInfo:{userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:""},url:CONFIG.HOST+CONFIG.SERVICE.getBankList,successCallback:function(a){200==a.code&&(e.allCarList=a.data)}})},bindBankCard:function(){var e=this;if(1!=e.isAction){if(utility.checkLen(e.bindCarInfo.bankId,0))return app.showPreloader("请选择一张银行卡"),void setTimeout(function(){app.hidePreloader()},1e3);if(utility.checkLen(e.bindCarInfo.cardNo,0))return app.showPreloader("请输入银行卡号"),void setTimeout(function(){app.hidePreloader()},1e3);if(utility.checkLen(e.bindCarInfo.bankAccountName,0))return app.showPreloader("请输入开户人"),void setTimeout(function(){app.hidePreloader()},1e3);if(utility.checkLen(e.bindCarInfo.subBankName,0))return app.showPreloader("请输入开户行"),void setTimeout(function(){app.hidePreloader()},1e3);if(utility.checkLen(e.payPwd,0))return app.showPreloader("请输入支付密码"),void setTimeout(function(){app.hidePreloader()},1e3);e.bindCarInfo.payPwd=md5(e.payPwd).toUpperCase(),utility.interactWithServer({headerInfo:{userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.walletService,CONFIG.ACTION.bindBankCard,e.bindCarInfo)},url:CONFIG.HOST+CONFIG.SERVICE.walletService,dataObj:e.bindCarInfo,beforeSendCallback:function(){app.showIndicator()},completeCallback:function(a,t){app.hideIndicator(),e.isAction=!1},successCallback:function(a){200==a.code?(e.getUserBindCardList(),app.closeModal(".popup-about")):(app.showPreloader(a.message),setTimeout(function(){app.hidePreloader()},1e3))}})}},getUserBindCardList:function(){var e=this;utility.interactWithServer({headerInfo:{userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.walletService,CONFIG.ACTION.getUserBankCards,{action:CONFIG.ACTION.getUserBankCards})},url:CONFIG.HOST+CONFIG.SERVICE.walletService,dataObj:{action:CONFIG.ACTION.getUserBankCards},successCallback:function(a){if(200==a.code){e.myCarList=a.data;for(var t=0,i=e.myCarList.length;t<i;t++)if(1==e.myCarList[t].isDefault){e.depositInfo.bindBankCardId=e.myCarList[t].bindBankCardId;break}}}})},setDefaultBankCard:function(e){var a=this;utility.interactWithServer({headerInfo:{userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.walletService,CONFIG.ACTION.setDefaultBankCard,{action:CONFIG.ACTION.setDefaultBankCard,bindBankCardId:e})},url:CONFIG.HOST+CONFIG.SERVICE.walletService,dataObj:{action:CONFIG.ACTION.setDefaultBankCard,bindBankCardId:e},successCallback:function(e){200==e.code&&a.getUserBindCardList()}})},depositAction:function(){var e=this,e=this;if(1!=e.isAction){if(utility.checkLen(e.depositInfo.bindBankCardId,0))return app.showPreloader("请选择一张银行卡"),void setTimeout(function(){app.hidePreloader()},1e3);if(utility.checkLen(e.amount,0))return app.showPreloader("请输入提现金额"),void setTimeout(function(){app.hidePreloader()},1e3);if(utility.checkLen(e.depositPwd,0))return app.showPreloader("请输入支付密码"),void setTimeout(function(){app.hidePreloader()},1e3);e.depositInfo.amount=100*e.amount,e.depositInfo.payPwd=md5(e.depositPwd).toUpperCase(),e.depositInfo.remark=encodeURIComponent(e.remark),utility.interactWithServer({headerInfo:{userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.walletService,CONFIG.ACTION.userWithdrawCash,e.depositInfo)},url:CONFIG.HOST+CONFIG.SERVICE.walletService,dataObj:e.depositInfo,beforeSendCallback:function(){app.showIndicator()},completeCallback:function(a,t){app.hideIndicator(),e.isAction=!1},successCallback:function(e){200==e.code||(app.showPreloader(e.message),setTimeout(function(){app.hidePreloader()},1e3))}})}}},created:function(){var e=this;e.getUserBindCardList(),e.getAllBankList()}})})();