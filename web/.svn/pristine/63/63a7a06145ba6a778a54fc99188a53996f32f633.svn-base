(function(){var e=utility.getQueryParams();new Vue({el:"#js-pageOrderDetail",data:{orderDetailInfo:null,userInfo:USERINFO,orderInfo:{action:CONFIG.ACTION.getOrderDetail,sysOpStr:"sss@2018",orderCode:e.orderCode},paramInfo:{orderCode:"",action:CONFIG.ACTION.payOrder,goToUrl:"/www/view/user/order.html"},url:LOCATION,shopDealStatus:CONFIG.SHOPDEALSTATUS,matchStatu:CONFIG.MATCHSTATU,orderStatuList:CONFIG.ORDERSTATU,downTimeInfo:null,timeInterval:null},methods:{userLogout:function(){utility.userLogout(function(){window.location.replace(CONFIG.HOST+"/shop/view/user/login.html")})},getOrderDetail:function(){var e=this;utility.interactWithServer({headerInfo:{appType:"2",userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.commonOrderService,CONFIG.ACTION.getOrderList,e.orderInfo)},url:CONFIG.HOST+CONFIG.SERVICE.commonOrderService,dataObj:e.orderInfo,successCallback:function(r){200==r.code&&(e.orderDetailInfo=r.data,1001==e.orderDetailInfo.lotteryTypeId&&utility.geFbMatchScoreData({mid:"",num:"",callback:function(r){e.footBallData=r.data}}),e.dountDownTime())}})},modifyOrderByShop:function(e,r){var t=this;if(confirm("确定修改?")){if(1==t.isClick)return;utility.interactWithServer({headerInfo:{appType:"2",userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.commonOrderService,CONFIG.ACTION.modifyOrderByShop,{shopWorkerId:USERINFO.userId,shopDealStatus:e,orderCode:r,action:CONFIG.ACTION.modifyOrderByShop})},url:CONFIG.HOST+CONFIG.SERVICE.commonOrderService,dataObj:{shopWorkerId:USERINFO.userId,shopDealStatus:e,orderCode:r,action:CONFIG.ACTION.modifyOrderByShop},completeCallback:function(){t.isClick=!1},successCallback:function(e){200==e.code?(t.getOrderDetail(),utility.getShopOrderStat(function(e){USERINFO.totalUntreatedOrders=e.data.totalUntreatedOrders,USERINFO.totalReceivedOrders=e.data.totalReceivedOrders,USERINFO.totalPrintedOrders=e.data.totalPrintedOrders,USERINFO.totalOrders=e.data.totalOrders,USERINFO.totalRejectedOrders=e.data.totalRejectedOrders,t.userInfo=USERINFO})):alert(e.message)}})}},dountDownTime:function(){var e=this;e.timeInterval=setInterval(function(){e.orderDetailInfo.planAwardTime&&(e.downTimeInfo=utility.leftTimer(new Date(e.orderDetailInfo.planAwardTime.replace(/-/g,"/")),new Date),e.downTimeInfo.days<=0&&e.downTimeInfo.minutes<=0&&e.downTimeInfo.seconds<=0&&clearInterval(e.timeInterval))},1e3)},submitOrder:function(){var e=this;e.orderInfo.backUrl=CONFIG.HOST+"/shop/view/order/result.html?paramInfo="+encodeURI(JSON.stringify(e.paramInfo)),window.location.href=CONFIG.HOST+utility.formatActionUrl(CONFIG.SERVICE.walletService,CONFIG.ACTION.payOrder,e.orderInfo,!0)+"&userId="+USERINFO.userId+"&userToken="+USERINFO.userToken+"&appType=2"}},created:function(){var e=this;e.getOrderDetail(),setTimeout(function(){e.userInfo=USERINFO},2e3)}})})();