(function(){new Vue({el:"#js-pageDeposit",data:{userInfo:USERINFO,isAction:!1,showAddList:!1,allCarList:[],myCarList:[],bindCarInfo:{bankId:"",bankName:"",cardNo:"",bankAccountName:"",subBankName:"",action:CONFIG.ACTION.bindBankCard,payPwd:""},payPwd:"",amount:"",bankAccountName:"",subBankName:"",depositInfo:{amount:"",action:CONFIG.ACTION.userWithdrawCash,remark:"",payPwd:"",bindBankCardId:""},depositPwd:"",remark:"",defaultBankId:""},watch:{"bindCarInfo.bankId":function(e){for(var a=this,t=0,n=a.allCarList.length;t<n;t++)if(a.allCarList[t].bankId==e){a.bindCarInfo.bankName=encodeURIComponent(a.allCarList[t].bankName);break}}},methods:{userLogout:function(){utility.userLogout(function(){window.location.replace(CONFIG.HOST+"/www/index.html")})},getAllBankList:function(){var e=this;utility.interactWithServer({headerInfo:{appType:"2",userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:""},url:CONFIG.HOST+CONFIG.SERVICE.getBankList,successCallback:function(a){200==a.code&&(e.allCarList=a.data)}})},bindBankCard:function(){var e=this;if(1!=e.isAction){if(utility.checkLen(e.bindCarInfo.bankId,0))return void alert("请选择一张银行卡");if(utility.checkLen(e.bindCarInfo.cardNo,0))return void alert("请输入银行卡号");if(utility.checkLen(e.bindCarInfo.bankAccountName,0))return void alert("请输入开户人");if(utility.checkLen(e.bindCarInfo.subBankName,0))return void alert("请输入开户行");if(utility.checkLen(e.payPwd,0))return void alert("请输入支付密码");e.bindCarInfo.payPwd=md5(e.payPwd).toUpperCase(),e.bindCarInfo.bankAccountName=encodeURIComponent(e.bankAccountName),e.bindCarInfo.subBankName=encodeURIComponent(e.subBankName),utility.interactWithServer({headerInfo:{appType:"2",userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.walletService,CONFIG.ACTION.bindBankCard,e.bindCarInfo)},url:CONFIG.HOST+CONFIG.SERVICE.walletService,dataObj:e.bindCarInfo,completeCallback:function(a,t){e.isAction=!1},successCallback:function(a){200==a.code?(e.getUserBindCardList(),e.showAddList=!1):alert(a.message)}})}},isShowAddList:function(e){var a=this;a.showAddList=e},getUserBindCardList:function(){var e=this;utility.interactWithServer({headerInfo:{appType:"2",userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.walletService,CONFIG.ACTION.getUserBankCards,{action:CONFIG.ACTION.getUserBankCards})},url:CONFIG.HOST+CONFIG.SERVICE.walletService,dataObj:{action:CONFIG.ACTION.getUserBankCards},successCallback:function(a){if(200==a.code){e.myCarList=a.data||[];for(var t=0,n=e.myCarList.length;t<n;t++)if(1==e.myCarList[t].isDefault){e.depositInfo.bindBankCardId=e.myCarList[t].bindBankCardId;break}}}})},setDefaultBankCard:function(e){var a=this;utility.interactWithServer({headerInfo:{appType:"2",userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.walletService,CONFIG.ACTION.setDefaultBankCard,{action:CONFIG.ACTION.setDefaultBankCard,bindBankCardId:e})},url:CONFIG.HOST+CONFIG.SERVICE.walletService,dataObj:{action:CONFIG.ACTION.setDefaultBankCard,bindBankCardId:e},successCallback:function(e){200==e.code&&a.getUserBindCardList()}})},depositAction:function(){var e=this;if(1!=e.isAction){if(utility.checkLen(e.depositInfo.bindBankCardId,0))return void alert("请选择一张银行卡");if(utility.checkLen(e.amount,0))return void alert("请输入提现金额");if(utility.checkLen(e.depositPwd,0))return void alert("请输入支付密码");e.depositInfo.amount=e.amount,e.depositInfo.payPwd=md5(e.depositPwd).toUpperCase(),e.depositInfo.remark=encodeURIComponent(e.remark),utility.interactWithServer({headerInfo:{appType:"2",userId:USERINFO?USERINFO.userId:"",userToken:USERINFO?USERINFO.userToken:"",actionUrl:utility.formatActionUrl(CONFIG.SERVICE.walletService,CONFIG.ACTION.userWithdrawCash,e.depositInfo)},url:CONFIG.HOST+CONFIG.SERVICE.walletService,dataObj:e.depositInfo,completeCallback:function(a,t){e.isAction=!1},successCallback:function(e){200==e.code?window.location.href=CONFIG.HOST+"/www/view/user/depRech.html":alert(e.message)}})}}},created:function(){var e=this;e.getUserBindCardList(),e.getAllBankList()}})})();