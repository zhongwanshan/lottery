(function(){new Vue({el:"#js-pageBuyBasketball",data:{matchList:[],matchData:null,matchInfoObj:null,totalOrderPrice:0,selectItem:{num:0},buyInfo:{action:CONFIG.ACTION.previewOrder,lotteryTypeId:"1004",issueNo:"",type:0,betDetail:"",multipleNum:1},cgDetail:"CG_2_1",cgList:["2串1"],cgInfo:CONFIG.CG,winList:[{name:"1-5分",value:"h0105"},{name:"6-10分",value:"h0610"},{name:"11-15分",value:"h1115"},{name:"16-20分",value:"h1620"},{name:"21-25分",value:"h2125"},{name:"26+",value:"h2600"}],loseList:[{name:"1-5分",value:"c0105"},{name:"6-10分",value:"c0610"},{name:"11-15分",value:"c1115"},{name:"16-20分",value:"c1620"},{name:"21-25分",value:"c2125"},{name:"26+",value:"c2600"}],isShowMenu:!1},watch:{cgList:function(e){for(var t=this,n=[],a=0,i=e.length;a<i;a++)n.push(t.cgInfo[e[a]]);t.cgDetail=n.join(","),t.cgList.length>0&&t.countSelectItem(t.matchInfoObj)},"buyInfo.multipleNum":function(e){var t=this;e<=0&&(t.buyInfo.multipleNum=1),t.cgList.length>0&&t.countSelectItem(t.matchInfoObj)}},methods:{showMenu:function(){var e=this;e.isShowMenu=!e.isShowMenu},setCheckBox:function(e){for(var t=[],n=0,a=e.length;n<a;n++)(function(n){e[n].matchInfo={sf:[],rang:[],score:[],win:[],lose:[]},t.push(e[n])})(n);return t},formatMatchData:function(){for(var e=this,t={},n=0,a=e.matchList.length;n<a;n++)(function(n){var a=e.matchList[n].dtime.split(" ")[0];t[a]={list:[],weekDay:"",time:""}})(n);for(var i in t)if(t.hasOwnProperty(i))for(var c=0,o=e.matchList.length;c<o;c++)(function(n){var a=e.matchList[n].dtime,c=a.split(" ")[0],o=utility.getCurrentTimeInfo(c);i==c&&(t[i].list.push(e.matchList[n]),t[i].weekDay=o.weekDay,t[i].time=c)})(c);e.matchInfoObj=t},geBkBlendMatches:function(){var e=this;utility.geBkBlendMatches({matchDay:"",type:1,callback:function(t){e.matchList=e.setCheckBox(t.data),e.formatMatchData(),utility.setiScroll("page"+PAGE.name)}})},showPopupAndSetData:function(e,t){var n=this;n.matchData={key:e,index:t,data:n.matchInfoObj[e].list[t]},app.popup(".popup-setData")},getCheckResult:function(e){for(var t=[],n=0,a=e.length;n<a;n++)t.push(e[n].split(",")[3]);return t.join(",")},reFormatMatch:function(e){for(var t=[],n=0,a=e.length;n<a;n++)t.push(n+1+"|"+e[n]);return t.join("#")},countSelectItem:function(e){var t=this,n=0,a="",i=[];for(var c in e)if(e.hasOwnProperty(c))for(var o=0,l=e[c].list.length;o<l;o++){var r=e[c].list[o],u=r.matchInfo,s=u.sf,h=u.rang,m=u.score,f=u.win,g=u.lose,v=s.length,p=h.length,I=m.length,d=f.length,y=g.length;v+p+I+d+y>0&&(n++,i.push(r.mid+"|"+r.num+"|"+(s.length>0?t.getCheckResult(s):"")+(h.length>0?","+t.getCheckResult(h):"")+(m.length>0?","+t.getCheckResult(m):"")+(f.length>0?","+t.getCheckResult(f):"")+(g.length>0?t.getCheckResult(g):"")))}a=t.reFormatMatch(i)+(t.cgDetail.length>0?"%"+t.cgDetail:""),t.buyInfo.betDetail=a,t.selectItem.num=n,t.setOrderInfo()},setOrderInfo:function(){var e=this;e.selectItem.num>1&&utility.previewOrder({service:CONFIG.SERVICE.bOrderService,params:e.buyInfo,callback:function(t){utility.setSessionStorage("orderInfo",{buyInfo:e.buyInfo}),utility.setSessionStorage("resultList",t.matchList),e.totalOrderPrice=t.totalOrderPrice}})},generateOrder:function(){var e=this;return e.selectItem.num<=1?(app.showPreloader("请至少选择两场球赛"),setTimeout(function(){app.hidePreloader()},1e3),!1):void utility.generateOrder({service:CONFIG.SERVICE.bOrderService,callback:function(e){mainView.router.loadPage("view/order/pay.html")}})}},created:function(){var e=this;e.geBkBlendMatches(),e.$watch("matchInfoObj",function(t,n){e.countSelectItem(t)},{deep:!0}),$("body").find(".js-showMenu").on("click",function(){e.isShowMenu=!e.isShowMenu})}})})();